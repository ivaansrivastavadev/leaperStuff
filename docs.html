<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LeaperDocs</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
/* LeaperDocs - Glassmorphism Theme */
:root {
    --primary-color: #4a6cf7;
    --primary-dark: #3a5ce5;
    --secondary-color: #6c757d;
    --success-color: #28a745;
    --danger-color: #dc3545;
    --warning-color: #ffc107;
    --info-color: #17a2b8;
    --light-color: #f8f9fa;
    --dark-color: #343a40;
    
    --bg-primary: rgba(255, 255, 255, 0.1);
    --bg-secondary: rgba(255, 255, 255, 0.05);
    --bg-glass: rgba(255, 255, 255, 0.15);
    --bg-card: rgba(255, 255, 255, 0.2);
    --border-glass: rgba(255, 255, 255, 0.3);
    --text-primary: #ffffff;
    --text-secondary: rgba(255, 255, 255, 0.8);
    --shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
    --blur: blur(10px);
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: var(--text-primary);
    min-height: 100vh;
    overflow-x: hidden;
}

/* Navbar */
.navbar {
    display: flex;
    align-items: center;
    padding: 0.75rem 1.5rem;
    background: var(--bg-glass);
    backdrop-filter: var(--blur);
    border-bottom: 1px solid var(--border-glass);
    box-shadow: var(--shadow);
    position: sticky;
    top: 0;
    z-index: 100;
}

.navbar-brand {
    display: flex;
    align-items: center;
    font-size: 1.5rem;
    font-weight: 600;
    margin-right: 2rem;
}

.navbar-brand i {
    margin-right: 0.5rem;
    color: var(--primary-color);
}

.navbar-menu {
    display: flex;
    gap: 1rem;
}

.navbar-actions {
    display: flex;
    align-items: center;
    margin-left: auto;
    gap: 0.5rem;
}

.document-title {
    margin: 0 auto;
    font-size: 1.1rem;
    font-weight: 500;
    cursor: pointer;
    padding: 0.25rem 0.5rem;
    border-radius: 4px;
    transition: background 0.2s;
}

.document-title:hover {
    background: var(--bg-secondary);
}

.document-title input {
    background: transparent;
    border: none;
    color: var(--text-primary);
    font-size: 1.1rem;
    font-weight: 500;
    text-align: center;
    width: 300px;
}

.document-title input:focus {
    outline: none;
    background: var(--bg-card);
    border-radius: 4px;
}

/* Buttons */
.btn {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem 1rem;
    background: var(--bg-glass);
    border: 1px solid var(--border-glass);
    border-radius: 6px;
    color: var(--text-primary);
    font-size: 0.9rem;
    cursor: pointer;
    transition: all 0.2s;
    backdrop-filter: var(--blur);
}

.btn:hover {
    background: var(--bg-card);
    transform: translateY(-2px);
}

.btn-primary {
    background: var(--primary-color);
    border-color: var(--primary-color);
}

.btn-primary:hover {
    background: var(--primary-dark);
}

.btn-link {
    background: transparent;
    border: none;
}

.btn-link:hover {
    background: var(--bg-secondary);
    transform: none;
}

/* Dropdowns */
.dropdown {
    position: relative;
    display: inline-block;
}

.dropdown-content {
    display: none;
    position: absolute;
    top: 100%;
    left: 0;
    min-width: 250px;
    padding: 1rem;
    z-index: 1000;
    margin-top: 0.5rem;
    box-shadow: var(--shadow);
}

.dropdown-section {
    margin-bottom: 1rem;
}

.dropdown-section:last-child {
    margin-bottom: 0;
}

.dropdown-section h4 {
    margin-bottom: 0.5rem;
    font-size: 0.9rem;
    color: var(--text-secondary);
}

/* Toolbar */
.toolbar {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 0.75rem 1.5rem;
    background: var(--bg-glass);
    backdrop-filter: var(--blur);
    border-bottom: 1px solid var(--border-glass);
    transition: all 0.3s;
}

.toolbar.minimized {
    padding: 0.5rem 1.5rem;
}

.toolbar.minimized .toolbar-group:not(:first-child) {
    display: none;
}

.toolbar-group {
    display: flex;
    align-items: center;
    gap: 0.25rem;
    padding-right: 1rem;
    border-right: 1px solid var(--border-glass);
}

.toolbar-group:last-child {
    border-right: none;
}

.toolbar .btn {
    padding: 0.5rem;
}

/* Main Container */
.main-container {
    display: flex;
    height: calc(100vh - 120px);
}

/* Sidebar */
.sidebar {
    width: 300px;
    background: var(--bg-glass);
    backdrop-filter: var(--blur);
    border-right: 1px solid var(--border-glass);
    transform: translateX(-100%);
    transition: transform 0.3s;
    position: fixed;
    top: 0;
    left: 0;
    height: 100%;
    z-index: 90;
    overflow-y: auto;
}

.sidebar.active {
    transform: translateX(0);
}

.sidebar-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1.5rem;
    border-bottom: 1px solid var(--border-glass);
}

.sidebar-content {
    padding: 1rem;
}

.file-actions {
    display: flex;
    gap: 0.5rem;
    margin-bottom: 1rem;
}

.file-list {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.file-item {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 0.75rem;
    border-radius: 6px;
    cursor: pointer;
    transition: background 0.2s;
}

.file-item:hover {
    background: var(--bg-secondary);
}

.file-item.active {
    background: var(--bg-card);
}

.file-title {
    flex: 1;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.file-actions {
    display: flex;
    gap: 0.25rem;
    opacity: 0;
    transition: opacity 0.2s;
}

.file-item:hover .file-actions {
    opacity: 1;
}

.file-action {
    padding: 0.25rem;
}

/* Editor Container */
.editor-container {
    flex: 1;
    padding: 2rem;
    overflow-y: auto;
    display: flex;
    justify-content: center;
    transition: all 0.3s;
}

.editor-container.full-width {
    padding: 2rem 0;
}

.editor-container.full-width .document-canvas {
    max-width: 100%;
    margin: 0;
}

/* Document Canvas */
.document-canvas {
    width: 100%;
    max-width: 800px;
    min-height: 1000px;
    background: var(--bg-card);
    backdrop-filter: var(--blur);
    box-shadow: var(--shadow);
    padding: 3rem;
    margin: 0 auto;
    transition: all 0.3s;
}

.document-canvas.print-layout {
    background: white;
    color: #333;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
}

#editor {
    min-height: 100%;
    outline: none;
    line-height: 1.6;
    transition: transform 0.3s;
}

#editor:focus {
    outline: none;
}

#editor p {
    margin-bottom: 1rem;
}

#editor h1, #editor h2, #editor h3 {
    margin: 1.5rem 0 1rem;
}

#editor ul, #editor ol {
    margin-left: 1.5rem;
    margin-bottom: 1rem;
}

/* Status Bar */
.status-bar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.5rem 1.5rem;
    background: var(--bg-glass);
    backdrop-filter: var(--blur);
    border-top: 1px solid var(--border-glass);
    font-size: 0.85rem;
    color: var(--text-secondary);
    transition: all 0.3s;
}

.status-bar.hidden {
    display: none;
}

.status-left, .status-right {
    display: flex;
    gap: 1rem;
}

/* Modals */
.modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5);
    z-index: 1000;
    align-items: center;
    justify-content: center;
}

.modal.active {
    display: flex;
}

.modal-content {
    width: 90%;
    max-width: 500px;
    max-height: 90vh;
    overflow-y: auto;
}

.modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1.5rem;
    border-bottom: 1px solid var(--border-glass);
}

.modal-body {
    padding: 1.5rem;
}

.modal-actions {
    display: flex;
    justify-content: flex-end;
    gap: 0.5rem;
    margin-top: 1.5rem;
}

/* Form Controls */
.form-control {
    width: 100%;
    padding: 0.75rem;
    background: var(--bg-glass);
    border: 1px solid var(--border-glass);
    border-radius: 6px;
    color: var(--text-primary);
    font-size: 0.9rem;
    backdrop-filter: var(--blur);
}

.form-control:focus {
    outline: none;
    border-color: var(--primary-color);
}

.form-group {
    margin-bottom: 1rem;
}

.form-group label {
    display: block;
    margin-bottom: 0.5rem;
    font-size: 0.9rem;
    color: var(--text-secondary);
}

/* Toggle Switch */
.toggle {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    cursor: pointer;
    margin-bottom: 0.5rem;
}

.toggle input {
    display: none;
}

.toggle-slider {
    position: relative;
    width: 40px;
    height: 20px;
    background: var(--bg-glass);
    border-radius: 20px;
    transition: background 0.3s;
}

.toggle-slider:before {
    content: '';
    position: absolute;
    width: 16px;
    height: 16px;
    background: white;
    border-radius: 50%;
    top: 2px;
    left: 2px;
    transition: transform 0.3s;
}

.toggle input:checked + .toggle-slider {
    background: var(--primary-color);
}

.toggle input:checked + .toggle-slider:before {
    transform: translateX(20px);
}

/* Tables */
.table {
    width: 100%;
    border-collapse: collapse;
    margin: 1rem 0;
}

.table td, .table th {
    border: 1px solid var(--border-glass);
    padding: 0.5rem;
    text-align: left;
}

.table th {
    background: var(--bg-secondary);
}

/* Document List */
.document-list {
    max-height: 300px;
    overflow-y: auto;
}

.document-item {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 0.75rem;
    border-radius: 6px;
    cursor: pointer;
    transition: background 0.2s;
}

.document-item:hover {
    background: var(--bg-secondary);
}

.document-title {
    flex: 1;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.document-date {
    font-size: 0.8rem;
    color: var(--text-secondary);
}

/* Empty State */
.empty-state {
    text-align: center;
    padding: 2rem;
    color: var(--text-secondary);
}

/* User Avatar */
.user-avatar {
    width: 36px;
    height: 36px;
    border-radius: 50%;
    background: var(--bg-card);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.2rem;
}

/* Notifications */
.notification {
    position: fixed;
    top: 20px;
    right: 20px;
    padding: 1rem 1.5rem;
    z-index: 1100;
    animation: slideIn 0.3s;
}

.notification.fade-out {
    animation: slideOut 0.3s forwards;
}

@keyframes slideIn {
    from { transform: translateX(100%); opacity: 0; }
    to { transform: translateX(0); opacity: 1; }
}

@keyframes slideOut {
    from { transform: translateX(0); opacity: 1; }
    to { transform: translateX(100%); opacity: 0; }
}

/* Liquid Glass Effect */
.liquid-glass {
    background: var(--bg-glass);
    backdrop-filter: var(--blur);
    border: 1px solid var(--border-glass);
    border-radius: 12px;
}

.card {
    box-shadow: var(--shadow);
}

/* Responsive Design */
@media (max-width: 768px) {
    .navbar-menu {
        display: none;
    }
    
    .toolbar {
        flex-wrap: wrap;
        gap: 0.5rem;
    }
    
    .toolbar-group {
        border-right: none;
        padding-right: 0;
    }
    
    .editor-container {
        padding: 1rem;
    }
    
    .document-canvas {
        padding: 1.5rem;
    }
    
    .status-bar {
        flex-direction: column;
        gap: 0.5rem;
        align-items: flex-start;
    }
}
    </style>
</head>
<body>
    <!-- Top Navigation Bar -->
    <nav class="navbar">
        <div class="navbar-brand">
            <i class="fas fa-file-alt"></i>
            <span>LeaperDocs</span>
        </div>
        
        <!-- Files Menu -->
        <div class="navbar-menu">
            <div class="dropdown">
                <button class="btn btn-link" id="files-menu">
                    <i class="fas fa-folder"></i> Files
                </button>
                <div class="dropdown-content card liquid-glass">
                    <div class="dropdown-section">
                        <button class="btn btn-primary" id="new-document">
                            <i class="fas fa-plus"></i> New Document
                        </button>
                        <button class="btn" id="save-document">
                            <i class="fas fa-save"></i> Save
                        </button>
                        <button class="btn" id="duplicate-document">
                            <i class="fas fa-copy"></i> Duplicate
                        </button>
                    </div>
                    <div class="dropdown-section">
                        <h4>Recent Documents</h4>
                        <div id="document-list" class="document-list">
                            <!-- Documents will be loaded here -->
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- View Menu -->
            <div class="dropdown">
                <button class="btn btn-link" id="view-menu">
                    <i class="fas fa-eye"></i> View
                </button>
                <div class="dropdown-content card liquid-glass">
                    <div class="dropdown-section">
                        <button class="btn" id="zoom-in">
                            <i class="fas fa-search-plus"></i> Zoom In
                        </button>
                        <button class="btn" id="zoom-out">
                            <i class="fas fa-search-minus"></i> Zoom Out
                        </button>
                        <button class="btn" id="reset-zoom">
                            <i class="fas fa-search"></i> Reset Zoom
                        </button>
                    </div>
                    <div class="dropdown-section">
                        <label class="toggle">
                            <input type="checkbox" id="print-layout">
                            <span class="toggle-slider"></span>
                            <span>Print Layout</span>
                        </label>
                        <label class="toggle">
                            <input type="checkbox" id="full-width">
                            <span class="toggle-slider"></span>
                            <span>Full Width</span>
                        </label>
                    </div>
                </div>
            </div>
            
            <!-- Insert Menu -->
            <div class="dropdown">
                <button class="btn btn-link" id="insert-menu">
                    <i class="fas fa-plus-circle"></i> Insert
                </button>
                <div class="dropdown-content card liquid-glass">
                    <div class="dropdown-section">
                        <button class="btn" id="insert-image">
                            <i class="fas fa-image"></i> Image
                        </button>
                        <button class="btn" id="insert-table">
                            <i class="fas fa-table"></i> Table
                        </button>
                        <button class="btn" id="insert-hr">
                            <i class="fas fa-minus"></i> Horizontal Line
                        </button>
                    </div>
                    <div class="dropdown-section">
                        <button class="btn" id="insert-date">
                            <i class="fas fa-calendar"></i> Date & Time
                        </button>
                        <button class="btn" id="insert-page-break">
                            <i class="fas fa-file-alt"></i> Page Break
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Other Menu -->
            <div class="dropdown">
                <button class="btn btn-link" id="other-menu">
                    <i class="fas fa-cog"></i> Other
                </button>
                <div class="dropdown-content card liquid-glass">
                    <div class="dropdown-section">
                        <label class="toggle">
                            <input type="checkbox" id="markdown-mode">
                            <span class="toggle-slider"></span>
                            <span>Markdown Mode</span>
                        </label>
                        <label class="toggle">
                            <input type="checkbox" id="status-bar" checked>
                            <span class="toggle-slider"></span>
                            <span>Status Bar</span>
                        </label>
                    </div>
                    <div class="dropdown-section">
                        <button class="btn" id="word-count">
                            <i class="fas fa-font"></i> Word Count
                        </button>
                        <button class="btn" id="document-info">
                            <i class="fas fa-info-circle"></i> Document Info
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Document Title -->
        <div class="document-title">
            <span id="document-name">Untitled Document</span>
            <input type="text" id="document-name-input" class="form-control" style="display: none;">
        </div>
        
        <!-- User Controls -->
        <div class="navbar-actions">
            <button class="btn btn-link" id="minimize-ribbon" title="Minimize Ribbon">
                <i class="fas fa-chevron-up"></i>
            </button>
            <button class="btn btn-primary" id="share-button">
                <i class="fas fa-share"></i> Share
            </button>
            <div class="user-avatar">
                <i class="fas fa-user-circle"></i>
            </div>
        </div>
    </nav>
    
    <!-- Formatting Toolbar -->
    <div class="toolbar" id="formatting-toolbar">
        <div class="toolbar-group">
            <button class="btn" id="bold" title="Bold">
                <i class="fas fa-bold"></i>
            </button>
            <button class="btn" id="italic" title="Italic">
                <i class="fas fa-italic"></i>
            </button>
            <button class="btn" id="underline" title="Underline">
                <i class="fas fa-underline"></i>
            </button>
            <button class="btn" id="strikethrough" title="Strikethrough">
                <i class="fas fa-strikethrough"></i>
            </button>
        </div>
        
        <div class="toolbar-group">
            <select class="form-control" id="font-family">
                <option value="Arial">Arial</option>
                <option value="Georgia">Georgia</option>
                <option value="Times New Roman">Times New Roman</option>
                <option value="Verdana">Verdana</option>
                <option value="Courier New">Courier New</option>
            </select>
            
            <select class="form-control" id="font-size">
                <option value="1">8pt</option>
                <option value="2">10pt</option>
                <option value="3">12pt</option>
                <option value="4">14pt</option>
                <option value="5">18pt</option>
                <option value="6">24pt</option>
                <option value="7">36pt</option>
            </select>
        </div>
        
        <div class="toolbar-group">
            <button class="btn" id="text-color" title="Text Color">
                <i class="fas fa-palette"></i>
            </button>
            <button class="btn" id="highlight" title="Highlight">
                <i class="fas fa-highlighter"></i>
            </button>
        </div>
        
        <div class="toolbar-group">
            <button class="btn" id="align-left" title="Align Left">
                <i class="fas fa-align-left"></i>
            </button>
            <button class="btn" id="align-center" title="Align Center">
                <i class="fas fa-align-center"></i>
            </button>
            <button class="btn" id="align-right" title="Align Right">
                <i class="fas fa-align-right"></i>
            </button>
            <button class="btn" id="align-justify" title="Justify">
                <i class="fas fa-align-justify"></i>
            </button>
        </div>
        
        <div class="toolbar-group">
            <button class="btn" id="bullet-list" title="Bullet List">
                <i class="fas fa-list-ul"></i>
            </button>
            <button class="btn" id="number-list" title="Numbered List">
                <i class="fas fa-list-ol"></i>
            </button>
        </div>
        
        <div class="toolbar-group">
            <button class="btn" id="indent" title="Increase Indent">
                <i class="fas fa-indent"></i>
            </button>
            <button class="btn" id="outdent" title="Decrease Indent">
                <i class="fas fa-outdent"></i>
            </button>
        </div>
        
        <div class="toolbar-group">
            <button class="btn" id="undo" title="Undo">
                <i class="fas fa-undo"></i>
            </button>
            <button class="btn" id="redo" title="Redo">
                <i class="fas fa-redo"></i>
            </button>
            <button class="btn" id="clear-formatting" title="Clear Formatting">
                <i class="fas fa-eraser"></i>
            </button>
        </div>
    </div>
    
    <!-- Main Content Area -->
    <div class="main-container">
        <!-- Sidebar (File Manager) -->
        <div class="sidebar" id="file-manager">
            <div class="sidebar-header">
                <h3>Documents</h3>
                <button class="btn btn-link" id="close-sidebar">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="sidebar-content">
                <div class="file-actions">
                    <button class="btn btn-primary" id="sidebar-new-doc">
                        <i class="fas fa-plus"></i> New
                    </button>
                    <button class="btn" id="sidebar-import">
                        <i class="fas fa-file-import"></i> Import
                    </button>
                </div>
                <div class="file-list" id="file-list">
                    <!-- Files will be loaded here -->
                </div>
            </div>
        </div>
        
        <!-- Editor Area -->
        <div class="editor-container" id="editor-container">
            <div class="document-canvas card liquid-glass" id="document-canvas">
                <div class="page" id="editor" contenteditable="true">
                    <p>Start typing your document here...</p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Status Bar -->
    <div class="status-bar" id="status-bar">
        <div class="status-left">
            <span id="word-count-display">Words: 0</span>
            <span id="char-count-display">Characters: 0</span>
        </div>
        <div class="status-right">
            <span id="zoom-level">100%</span>
            <button class="btn btn-link" id="auto-save-status">
                <i class="fas fa-sync-alt"></i> Auto-save: On
            </button>
        </div>
    </div>
    
    <!-- Modals -->
    <div class="modal" id="image-upload-modal">
        <div class="modal-content card liquid-glass">
            <div class="modal-header">
                <h3>Insert Image</h3>
                <button class="btn btn-link close-modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <input type="file" id="image-upload" accept="image/*" class="form-control">
                <div class="modal-actions">
                    <button class="btn btn-primary" id="insert-image-btn">Insert</button>
                    <button class="btn close-modal">Cancel</button>
                </div>
            </div>
        </div>
    </div>
    
    <div class="modal" id="table-insert-modal">
        <div class="modal-content card liquid-glass">
            <div class="modal-header">
                <h3>Insert Table</h3>
                <button class="btn btn-link close-modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>Rows:</label>
                    <input type="number" id="table-rows" class="form-control" min="1" max="10" value="3">
                </div>
                <div class="form-group">
                    <label>Columns:</label>
                    <input type="number" id="table-cols" class="form-control" min="1" max="10" value="3">
                </div>
                <div class="modal-actions">
                    <button class="btn btn-primary" id="insert-table-btn">Insert</button>
                    <button class="btn close-modal">Cancel</button>
                </div>
            </div>
        </div>
    </div>
    
    <div class="modal" id="document-info-modal">
        <div class="modal-content card liquid-glass">
            <div class="modal-header">
                <h3>Document Information</h3>
                <button class="btn btn-link close-modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="info-item">
                    <strong>Created:</strong> <span id="info-created">-</span>
                </div>
                <div class="info-item">
                    <strong>Last Modified:</strong> <span id="info-modified">-</span>
                </div>
                <div class="info-item">
                    <strong>Words:</strong> <span id="info-words">0</span>
                </div>
                <div class="info-item">
                    <strong>Characters:</strong> <span id="info-chars">0</span>
                </div>
                <div class="info-item">
                    <strong>Pages:</strong> <span id="info-pages">1</span>
                </div>
            </div>
        </div>
    </div>
    
    <script>
      // LeaperDocs - Document Editor
document.addEventListener('DOMContentLoaded', function() {
    // DOM Elements
    const editor = document.getElementById('editor');
    const documentName = document.getElementById('document-name');
    const documentNameInput = document.getElementById('document-name-input');
    const fileManager = document.getElementById('file-manager');
    const fileList = document.getElementById('file-list');
    const documentList = document.getElementById('document-list');
    const statusBar = document.getElementById('status-bar');
    const formattingToolbar = document.getElementById('formatting-toolbar');
    const editorContainer = document.getElementById('editor-container');
    const documentCanvas = document.getElementById('document-canvas');
    
    // Current document state
    let currentDocument = {
        id: generateId(),
        name: 'Untitled Document',
        content: '',
        created: Date.now(),
        updated: Date.now()
    };
    
    let documents = [];
    let zoomLevel = 100;
    let isPrintLayout = false;
    let isFullWidth = false;
    let isMarkdownMode = false;
    let autoSaveInterval;
    
    // Initialize the editor
    function init() {
        loadDocuments();
        setupEventListeners();
        updateWordCount();
        startAutoSave();
        
        // Set initial document name
        documentName.textContent = currentDocument.name;
        
        // Load the first document if available
        if (documents.length > 0) {
            loadDocument(documents[0].id);
        }
    }
    
    // Generate a unique ID
    function generateId() {
        return 'doc_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
    }
    
    // Load documents from localStorage
    function loadDocuments() {
        const stored = localStorage.getItem('leaperdocs_documents');
        if (stored) {
            documents = JSON.parse(stored);
            renderDocumentList();
            renderFileList();
        }
    }
    
    // Save documents to localStorage
    function saveDocuments() {
        localStorage.setItem('leaperdocs_documents', JSON.stringify(documents));
    }
    
    // Render document list in dropdown
    function renderDocumentList() {
        documentList.innerHTML = '';
        
        if (documents.length === 0) {
            documentList.innerHTML = '<p class="empty-state">No documents yet</p>';
            return;
        }
        
        documents.forEach(doc => {
            const docElement = document.createElement('div');
            docElement.className = 'document-item';
            docElement.innerHTML = `
                <i class="fas fa-file-alt"></i>
                <span class="document-title">${doc.name}</span>
                <span class="document-date">${formatDate(doc.updated)}</span>
            `;
            docElement.addEventListener('click', () => loadDocument(doc.id));
            documentList.appendChild(docElement);
        });
    }
    
    // Render file list in sidebar
    function renderFileList() {
        fileList.innerHTML = '';
        
        if (documents.length === 0) {
            fileList.innerHTML = '<p class="empty-state">No documents yet</p>';
            return;
        }
        
        documents.forEach(doc => {
            const fileElement = document.createElement('div');
            fileElement.className = 'file-item';
            if (doc.id === currentDocument.id) {
                fileElement.classList.add('active');
            }
            fileElement.innerHTML = `
                <i class="fas fa-file-alt"></i>
                <span class="file-title">${doc.name}</span>
                <div class="file-actions">
                    <button class="btn btn-link file-action" data-action="rename" data-id="${doc.id}" title="Rename">
                        <i class="fas fa-edit"></i>
                    </button>
                    <button class="btn btn-link file-action" data-action="delete" data-id="${doc.id}" title="Delete">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
            `;
            fileElement.addEventListener('click', (e) => {
                if (!e.target.closest('.file-actions')) {
                    loadDocument(doc.id);
                }
            });
            fileList.appendChild(fileElement);
        });
        
        // Add event listeners to file actions
        document.querySelectorAll('.file-action').forEach(button => {
            button.addEventListener('click', handleFileAction);
        });
    }
    
    // Handle file actions (rename, delete)
    function handleFileAction(e) {
        const action = e.target.closest('.file-action').dataset.action;
        const docId = e.target.closest('.file-action').dataset.id;
        
        if (action === 'delete') {
            deleteDocument(docId);
        } else if (action === 'rename') {
            renameDocument(docId);
        }
    }
    
    // Load a document by ID
    function loadDocument(docId) {
        const doc = documents.find(d => d.id === docId);
        if (doc) {
            currentDocument = {...doc};
            editor.innerHTML = doc.content;
            documentName.textContent = doc.name;
            updateWordCount();
            
            // Update UI
            renderFileList();
            closeSidebar();
        }
    }
    
    // Create a new document
    function createNewDocument() {
        const newDoc = {
            id: generateId(),
            name: 'Untitled Document',
            content: '<p>Start typing your document here...</p>',
            created: Date.now(),
            updated: Date.now()
        };
        
        documents.unshift(newDoc);
        saveDocuments();
        loadDocument(newDoc.id);
        renderDocumentList();
        renderFileList();
    }
    
    // Save the current document
    function saveCurrentDocument() {
        currentDocument.content = editor.innerHTML;
        currentDocument.updated = Date.now();
        
        const index = documents.findIndex(d => d.id === currentDocument.id);
        if (index !== -1) {
            documents[index] = {...currentDocument};
        } else {
            documents.unshift({...currentDocument});
        }
        
        saveDocuments();
        renderDocumentList();
        renderFileList();
        
        // Show save confirmation
        showNotification('Document saved successfully');
    }
    
    // Duplicate the current document
    function duplicateDocument() {
        const duplicatedDoc = {
            ...currentDocument,
            id: generateId(),
            name: currentDocument.name + ' (Copy)',
            created: Date.now(),
            updated: Date.now()
        };
        
        documents.unshift(duplicatedDoc);
        saveDocuments();
        loadDocument(duplicatedDoc.id);
        renderDocumentList();
        renderFileList();
    }
    
    // Delete a document
    function deleteDocument(docId) {
        if (documents.length <= 1) {
            showNotification('Cannot delete the only document');
            return;
        }
        
        if (confirm('Are you sure you want to delete this document?')) {
            documents = documents.filter(d => d.id !== docId);
            saveDocuments();
            
            if (currentDocument.id === docId) {
                loadDocument(documents[0].id);
            }
            
            renderDocumentList();
            renderFileList();
        }
    }
    
    // Rename a document
    function renameDocument(docId) {
        const doc = documents.find(d => d.id === docId);
        if (!doc) return;
        
        const newName = prompt('Enter new document name:', doc.name);
        if (newName && newName.trim() !== '') {
            doc.name = newName.trim();
            
            if (currentDocument.id === docId) {
                currentDocument.name = newName.trim();
                documentName.textContent = newName.trim();
            }
            
            saveDocuments();
            renderDocumentList();
            renderFileList();
        }
    }
    
    // Export document as HTML
    function exportAsHTML() {
        const content = editor.innerHTML;
        const blob = new Blob([`<!DOCTYPE html><html><head><title>${currentDocument.name}</title></head><body>${content}</body></html>`], 
                             { type: 'text/html' });
        downloadBlob(blob, `${currentDocument.name}.html`);
    }
    
    // Export document as TXT
    function exportAsTXT() {
        const content = editor.innerText;
        const blob = new Blob([content], { type: 'text/plain' });
        downloadBlob(blob, `${currentDocument.name}.txt`);
    }
    
    // Helper function to download a blob
    function downloadBlob(blob, filename) {
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = filename;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
    }
    
    // Update word and character count
    function updateWordCount() {
        const text = editor.innerText || '';
        const words = text.trim() ? text.trim().split(/\s+/).length : 0;
        const characters = text.length;
        
        document.getElementById('word-count-display').textContent = `Words: ${words}`;
        document.getElementById('char-count-display').textContent = `Characters: ${characters}`;
        
        // Update document info modal if open
        document.getElementById('info-words').textContent = words;
        document.getElementById('info-chars').textContent = characters;
    }
    
    // Format date for display
    function formatDate(timestamp) {
        return new Date(timestamp).toLocaleDateString();
    }
    
    // Show notification
    function showNotification(message) {
        // Create notification element
        const notification = document.createElement('div');
        notification.className = 'notification card liquid-glass';
        notification.textContent = message;
        
        // Add to page
        document.body.appendChild(notification);
        
        // Remove after 3 seconds
        setTimeout(() => {
            notification.classList.add('fade-out');
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.parentNode.removeChild(notification);
                }
            }, 300);
        }, 3000);
    }
    
    // Toggle sidebar
    function toggleSidebar() {
        fileManager.classList.toggle('active');
    }
    
    // Close sidebar
    function closeSidebar() {
        fileManager.classList.remove('active');
    }
    
    // Toggle print layout
    function togglePrintLayout() {
        isPrintLayout = !isPrintLayout;
        documentCanvas.classList.toggle('print-layout', isPrintLayout);
    }
    
    // Toggle full width
    function toggleFullWidth() {
        isFullWidth = !isFullWidth;
        editorContainer.classList.toggle('full-width', isFullWidth);
    }
    
    // Toggle markdown mode
    function toggleMarkdownMode() {
        isMarkdownMode = !isMarkdownMode;
        // This would require a markdown parser to be fully implemented
        showNotification('Markdown mode ' + (isMarkdownMode ? 'enabled' : 'disabled'));
    }
    
    // Toggle status bar
    function toggleStatusBar() {
        statusBar.classList.toggle('hidden');
    }
    
    // Zoom in
    function zoomIn() {
        if (zoomLevel < 200) {
            zoomLevel += 10;
            updateZoom();
        }
    }
    
    // Zoom out
    function zoomOut() {
        if (zoomLevel > 50) {
            zoomLevel -= 10;
            updateZoom();
        }
    }
    
    // Reset zoom
    function resetZoom() {
        zoomLevel = 100;
        updateZoom();
    }
    
    // Update zoom level
    function updateZoom() {
        editor.style.transform = `scale(${zoomLevel / 100})`;
        document.getElementById('zoom-level').textContent = `${zoomLevel}%`;
    }
    
    // Minimize ribbon
    function minimizeRibbon() {
        formattingToolbar.classList.toggle('minimized');
        const icon = document.getElementById('minimize-ribbon').querySelector('i');
        if (formattingToolbar.classList.contains('minimized')) {
            icon.className = 'fas fa-chevron-down';
        } else {
            icon.className = 'fas fa-chevron-up';
        }
    }
    
    // Start auto-save
    function startAutoSave() {
        autoSaveInterval = setInterval(() => {
            if (currentDocument) {
                currentDocument.content = editor.innerHTML;
                currentDocument.updated = Date.now();
                
                const index = documents.findIndex(d => d.id === currentDocument.id);
                if (index !== -1) {
                    documents[index] = {...currentDocument};
                    saveDocuments();
                }
            }
        }, 2000); // Auto-save every 2 seconds
    }
    
    // Formatting functions
    function formatText(command, value = null) {
        document.execCommand(command, false, value);
        editor.focus();
    }
    
    // Insert image
    function insertImage() {
        document.getElementById('image-upload-modal').classList.add('active');
    }
    
    // Handle image upload
    function handleImageUpload() {
        const fileInput = document.getElementById('image-upload');
        const file = fileInput.files[0];
        
        if (file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                const img = document.createElement('img');
                img.src = e.target.result;
                img.style.maxWidth = '100%';
                
                // Insert at cursor position
                const selection = window.getSelection();
                if (selection.rangeCount > 0) {
                    const range = selection.getRangeAt(0);
                    range.deleteContents();
                    range.insertNode(img);
                } else {
                    editor.appendChild(img);
                }
                
                closeModal('image-upload-modal');
                fileInput.value = '';
            };
            reader.readAsDataURL(file);
        }
    }
    
    // Insert table
    function insertTable() {
        document.getElementById('table-insert-modal').classList.add('active');
    }
    
    // Handle table insertion
    function handleTableInsert() {
        const rows = parseInt(document.getElementById('table-rows').value) || 3;
        const cols = parseInt(document.getElementById('table-cols').value) || 3;
        
        let tableHTML = '<table class="table"><tbody>';
        for (let i = 0; i < rows; i++) {
            tableHTML += '<tr>';
            for (let j = 0; j < cols; j++) {
                tableHTML += '<td>&nbsp;</td>';
            }
            tableHTML += '</tr>';
        }
        tableHTML += '</tbody></table>';
        
        // Insert at cursor position
        const selection = window.getSelection();
        if (selection.rangeCount > 0) {
            const range = selection.getRangeAt(0);
            range.deleteContents();
            range.insertNode(document.createRange().createContextualFragment(tableHTML));
        } else {
            editor.innerHTML += tableHTML;
        }
        
        closeModal('table-insert-modal');
    }
    
    // Insert horizontal line
    function insertHorizontalLine() {
        formatText('insertHorizontalRule');
    }
    
    // Insert date/time
    function insertDateTime() {
        const now = new Date();
        const dateTimeString = now.toLocaleString();
        formatText('insertText', dateTimeString);
    }
    
    // Insert page break
    function insertPageBreak() {
        const pageBreak = document.createElement('div');
        pageBreak.className = 'page-break';
        pageBreak.innerHTML = '<hr style="page-break-after: always; visibility: hidden;">';
        
        // Insert at cursor position
        const selection = window.getSelection();
        if (selection.rangeCount > 0) {
            const range = selection.getRangeAt(0);
            range.deleteContents();
            range.insertNode(pageBreak);
        } else {
            editor.appendChild(pageBreak);
        }
    }
    
    // Show document info
    function showDocumentInfo() {
        document.getElementById('info-created').textContent = new Date(currentDocument.created).toLocaleString();
        document.getElementById('info-modified').textContent = new Date(currentDocument.updated).toLocaleString();
        document.getElementById('info-pages').textContent = '1'; // This would need to be calculated
        
        document.getElementById('document-info-modal').classList.add('active');
    }
    
    // Close modal
    function closeModal(modalId) {
        document.getElementById(modalId).classList.remove('active');
    }
    
    // Setup event listeners
    function setupEventListeners() {
        // Document name editing
        documentName.addEventListener('click', () => {
            documentName.style.display = 'none';
            documentNameInput.style.display = 'inline-block';
            documentNameInput.value = currentDocument.name;
            documentNameInput.focus();
        });
        
        documentNameInput.addEventListener('blur', () => {
            documentName.style.display = 'inline-block';
            documentNameInput.style.display = 'none';
            
            const newName = documentNameInput.value.trim();
            if (newName && newName !== currentDocument.name) {
                currentDocument.name = newName;
                documentName.textContent = newName;
                saveCurrentDocument();
            }
        });
        
        documentNameInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                documentNameInput.blur();
            }
        });
        
        // File actions
        document.getElementById('new-document').addEventListener('click', createNewDocument);
        document.getElementById('sidebar-new-doc').addEventListener('click', createNewDocument);
        document.getElementById('save-document').addEventListener('click', saveCurrentDocument);
        document.getElementById('duplicate-document').addEventListener('click', duplicateDocument);
        
        // View actions
        document.getElementById('zoom-in').addEventListener('click', zoomIn);
        document.getElementById('zoom-out').addEventListener('click', zoomOut);
        document.getElementById('reset-zoom').addEventListener('click', resetZoom);
        
        document.getElementById('print-layout').addEventListener('change', togglePrintLayout);
        document.getElementById('full-width').addEventListener('change', toggleFullWidth);
        
        // Insert actions
        document.getElementById('insert-image').addEventListener('click', insertImage);
        document.getElementById('insert-table').addEventListener('click', insertTable);
        document.getElementById('insert-hr').addEventListener('click', insertHorizontalLine);
        document.getElementById('insert-date').addEventListener('click', insertDateTime);
        document.getElementById('insert-page-break').addEventListener('click', insertPageBreak);
        
        document.getElementById('insert-image-btn').addEventListener('click', handleImageUpload);
        document.getElementById('insert-table-btn').addEventListener('click', handleTableInsert);
        
        // Other actions
        document.getElementById('markdown-mode').addEventListener('change', toggleMarkdownMode);
        document.getElementById('status-bar').addEventListener('change', toggleStatusBar);
        document.getElementById('word-count').addEventListener('click', updateWordCount);
        document.getElementById('document-info').addEventListener('click', showDocumentInfo);
        
        // Formatting buttons
        document.getElementById('bold').addEventListener('click', () => formatText('bold'));
        document.getElementById('italic').addEventListener('click', () => formatText('italic'));
        document.getElementById('underline').addEventListener('click', () => formatText('underline'));
        document.getElementById('strikethrough').addEventListener('click', () => formatText('strikethrough'));
        
        document.getElementById('align-left').addEventListener('click', () => formatText('justifyLeft'));
        document.getElementById('align-center').addEventListener('click', () => formatText('justifyCenter'));
        document.getElementById('align-right').addEventListener('click', () => formatText('justifyRight'));
        document.getElementById('align-justify').addEventListener('click', () => formatText('justifyFull'));
        
        document.getElementById('bullet-list').addEventListener('click', () => formatText('insertUnorderedList'));
        document.getElementById('number-list').addEventListener('click', () => formatText('insertOrderedList'));
        
        document.getElementById('indent').addEventListener('click', () => formatText('indent'));
        document.getElementById('outdent').addEventListener('click', () => formatText('outdent'));
        
        document.getElementById('undo').addEventListener('click', () => formatText('undo'));
        document.getElementById('redo').addEventListener('click', () => formatText('redo'));
        document.getElementById('clear-formatting').addEventListener('click', () => formatText('removeFormat'));
        
        // Font family and size
        document.getElementById('font-family').addEventListener('change', (e) => {
            formatText('fontName', e.target.value);
        });
        
        document.getElementById('font-size').addEventListener('change', (e) => {
            formatText('fontSize', e.target.value);
        });
        
        // UI controls
        document.getElementById('minimize-ribbon').addEventListener('click', minimizeRibbon);
        document.getElementById('files-menu').addEventListener('click', toggleSidebar);
        document.getElementById('close-sidebar').addEventListener('click', closeSidebar);
        
        // Close modals
        document.querySelectorAll('.close-modal').forEach(button => {
            button.addEventListener('click', function() {
                const modal = this.closest('.modal');
                if (modal) {
                    modal.classList.remove('active');
                }
            });
        });
        
        // Editor events
        editor.addEventListener('input', updateWordCount);
        editor.addEventListener('paste', (e) => {
            // Handle paste event to clean up formatting if needed
            e.preventDefault();
            const text = (e.originalEvent || e).clipboardData.getData('text/plain');
            document.execCommand('insertText', false, text);
        });
        
        // Close dropdowns when clicking outside
        document.addEventListener('click', (e) => {
            if (!e.target.closest('.dropdown')) {
                document.querySelectorAll('.dropdown-content').forEach(dropdown => {
                    dropdown.style.display = 'none';
                });
            }
        });
        
        // Initialize dropdowns
        document.querySelectorAll('.dropdown > .btn').forEach(button => {
            button.addEventListener('click', function(e) {
                e.stopPropagation();
                const dropdown = this.nextElementSibling;
                const isVisible = dropdown.style.display === 'block';
                
                // Hide all dropdowns
                document.querySelectorAll('.dropdown-content').forEach(d => {
                    d.style.display = 'none';
                });
                
                // Show this dropdown if it was hidden
                if (!isVisible) {
                    dropdown.style.display = 'block';
                }
            });
        });
    }
    
    // Initialize the application
    init();
});
    </script>
</body>
</html>