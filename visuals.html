<center><!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>leprVisuals – leaperStuff</title>
  <link rel="icon" type="image/x-icon" href="roundedlogo.gif">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Ubuntu+Sans:ital,wght@0,100..800;1,100..800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="basicstyle.css">
  <style>
    /* Grid layout for chart and controls */
    .main-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 2rem;
      min-height: calc(100vh - 120px);
    }
    
    .spreadsheet-controls, .chart-controls {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 15px;
      align-items: center;
    }
    
    .size-controls {
      display: flex;
      gap: 10px;
      align-items: center;
    }
    
    .custom-size-inputs {
      display: flex;
      gap: 10px;
    }
    
    #chartWrapper {
      width: 90%;
      height: 90vh;
      max-height: 90%;
      background: white;
      border-radius: 12px;
      padding: 20px;
      box-sizing: border-box;
      margin-bottom: 2rem;
      position: relative;
      overflow: hidden;
      border: 4px solid black;
    }
    
    #chartCanvas {
      width: 100% !important;
      height: 100% !important;
      background-color: white;
    }
    
    .screenshot-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.7);
      z-index: 1000;
      align-items: center;
      justify-content: center;
    }
    
    .screenshot-options {
      background: rgb(226, 232, 181);
      padding: 2rem;
      border-radius: 0;
      width: 90%;
      max-width: 500px;
      border: 4px solid black;
      box-shadow: black 5px 5px;
    }
    
    .modal-buttons {
      display: flex;
      gap: 10px;
      justify-content: flex-end;
      margin-top: 1rem;
    }
    
    /* Mobile responsiveness */
    @media (max-width: 768px) {
      .main-container {
        padding: 1rem;
      }
      
      .spreadsheet-controls, .chart-controls {
        flex-direction: column;
        align-items: stretch;
      }
      
      .size-controls {
        flex-wrap: wrap;
        justify-content: center;
      }
      
      #chartWrapper {
        width: 95%;
        padding: 1rem;
      }
    }
    
    /* Table styling */
    .spreadsheet table {
      border-collapse: collapse;
      background: white;
      color: black;
      border-radius: 0;
      overflow: hidden;
      width: 100%;
      margin-bottom: 15px;
      border: 2px solid black;
    }
    
    .spreadsheet th {
      background: rgb(242, 225, 33);
      color: #000;
      font-weight: bold;
      padding: 10px;
      text-align: center;
      border: 1px solid black;
    }
    
    .spreadsheet td {
      border: 1px solid black;
      padding: 0;
    }
    
    .spreadsheet input {
      width: 100%;
      border: none;
      text-align: center;
      background: transparent;
      color: black;
      padding: 8px;
      box-sizing: border-box;
      transition: all 0.3s ease;
    }
    
    .spreadsheet input:focus {
      outline: 2px solid rgb(242, 225, 33);
      background: rgba(242, 225, 33, 0.2);
    }
    
    /* Form elements */
    select {
      padding: 8px 12px;
      border-radius: 0;
      border: 2px solid black;
      background: rgb(212, 221, 146);
      color: black;
      cursor: pointer;
      transition: 0.3s;
      box-shadow: black 5px 5px;
    }
    
    select:hover {
      box-shadow: none;
    }
    
    .custom-size-inputs input {
      width: 80px;
      padding: 5px;
      border-radius: 0;
      border: 2px solid black;
      background: rgb(212, 221, 146);
      color: black;
      box-shadow: black 5px 5px;
    }
    
    .custom-size-inputs input:hover {
      box-shadow: none;
    }
    
    .option-group input[type="number"] {
      width: 80px;
      padding: 5px;
      border-radius: 0;
      border: 2px solid black;
      background: rgb(212, 221, 146);
      color: black;
      box-shadow: black 5px 5px;
    }
    
    .option-group input[type="number"]:hover {
      box-shadow: none;
    }
    
    /* Radio buttons */
    .option-group label {
      display: block;
      margin-bottom: 0.5rem;
      cursor: pointer;
    }
    
    input[type="radio"] {
      margin-right: 8px;
    }
  </style>
</head>
<body>
      <div class="page-header">
      <h1><a href="index.html">lepr</a>Visuals</h1>
      <p class="tagline">by <strong>leaperStuff</strong></p>
      <p>Create or upload data → Turn into stunning charts ✨</p>
    </div>

    <div class="spreadsheet basicsection">
      <h3>Spreadsheet Maker</h3>
      
      <div class="spreadsheet-controls">
        <button class="basicbutton" onclick="addRow()">+ Add Row</button>
        <button class="basicbutton" onclick="removeRow()">- Remove Row</button>
        
        <select id="presets" class="presets-select basicinput" onchange="loadPreset()">
          <option value="">Select a preset...</option>
          <option value="sales">Sales Data</option>
          <option value="expenses">Monthly Expenses</option>
          <option value="population">Population by Country</option>
          <option value="website">Website Traffic</option>
          <option value="product">Product Ratings</option>
        </select>
        
        <button class="basicbutton" onclick="downloadSpreadsheet()">Download as XLSX</button>
        <button class="basicbutton" onclick="document.getElementById('fileInput').click()">Upload XLSX</button>
        <input type="file" id="fileInput" accept=".xlsx" style="display: none" onchange="handleFileUpload(this.files)">
      </div>
      
      <table id="sheet">
        <tr>
          <th>Label</th>
          <th>Value</th>
        </tr>
        <tr>
          <td><input value="First"></td>
          <td><input value="1"></td>
        </tr>
        <tr>
          <td><input value="Second"></td>
          <td><input value="2"></td>
        </tr>
      </table>
      
      <div class="chart-controls">
        <label for="chartType">Chart Type:</label>
        <select id="chartType" class="basicinput">
          <option value="pie">Pie Chart</option>
          <option value="doughnut">Doughnut Chart</option>
          <option value="bar">Bar Chart</option>
          <option value="line">Line Chart</option>
          <option value="radar">Radar Chart</option>
          <option value="polarArea">Polar Area Chart</option>
          <option value="scatter">Scatter Plot</option>
          <option value="bubble">Bubble Chart</option>
        </select>
        
        <label for="chartSize">Chart Size:</label>
        <select id="chartSize" class="basicinput" onchange="toggleCustomSize()">
          <option value="window">Window Size</option>
          <option value="square">Square (1:1)</option>
          <option value="custom">Custom</option>
        </select>
        
        <div class="custom-size-inputs" id="customSizeInputs" style="display: none;">
          <input type="number" id="customWidth" class="basicinput" placeholder="Width" value="800">
          <input type="number" id="customHeight" class="basicinput" placeholder="Height" value="600">
        </div>
        
        <button class="basicbutton" onclick="generateChartFromSheet()">Generate Chart</button>
        <button class="basicbutton" onclick="showScreenshotOptions()">Download</button>
      </div>
    </div>
    
    <div id="chartWrapper" class="basicsection">
      <canvas id="chartCanvas"></canvas>
    </div>

    <div class="screenshot-modal" id="screenshotModal">
      <div class="screenshot-options basicsection">
        <h3>Download Options</h3>
        <div class="option-group">
          <label>
            <input type="radio" name="bgType" value="white" checked> White Background
          </label>
          <label>
            <input type="radio" name="bgType" value="transparent"> Transparent Background
          </label>
        </div>
        <div class="option-group">
          <label for="marginSize">Margin (px):</label>
          <input type="number" id="marginSize" class="basicinput" value="20" min="0" max="100">
        </div>
        <div class="modal-buttons">
          <button class="basicbutton" onclick="takeScreenshot()">Download</button>
          <button class="basicbutton" onclick="document.getElementById('screenshotModal').style.display = 'none'">Cancel</button>
        </div>

    <footer>© 2025 leaperStuff</footer>
  </div>

  <!-- Keep libraries for Excel parsing (future upload feature) -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    let chart;
    const presetData = {
      sales: {
        headers: ["Month", "Sales"],
        data: [
          ["January", 12000],
          ["February", 15000],
          ["March", 18000],
          ["April", 14000],
          ["May", 21000],
          ["June", 19000]
        ]
      },
      expenses: {
        headers: ["Category", "Amount"],
        data: [
          ["Housing", 1200],
          ["Food", 500],
          ["Transportation", 300],
          ["Entertainment", 200],
          ["Utilities", 150],
          ["Healthcare", 100]
        ]
      },
      population: {
        headers: ["Country", "Population (millions)"],
        data: [
          ["China", 1412],
          ["India", 1380],
          ["USA", 331],
          ["Indonesia", 273],
          ["Pakistan", 225],
          ["Brazil", 213]
        ]
      },
      website: {
        headers: ["Page", "Visits"],
        data: [
          ["Home", 15000],
          ["About", 8000],
          ["Products", 12000],
          ["Contact", 3000],
          ["Blog", 6000]
        ]
      },
      product: {
        headers: ["Product", "Rating"],
        data: [
          ["Product A", 4.5],
          ["Product B", 3.8],
          ["Product C", 4.2],
          ["Product D", 4.7],
          ["Product E", 3.9]
        ]
      }
    };

    function addRow() {
      const table = document.getElementById("sheet");
      const cols = table.rows[0].cells.length;
      const row = table.insertRow();
      for (let i = 0; i < cols; i++) {
        const cell = row.insertCell();
        cell.innerHTML = '<input class="basicinput">';
      }
    }

    function removeRow() {
      const table = document.getElementById("sheet");
      if (table.rows.length > 2) {
        table.deleteRow(table.rows.length - 1);
      } else {
        alert("Need at least one data row.");
      }
    }

    function loadPreset() {
      const preset = document.getElementById("presets").value;
      if (!preset) return;
      
      const data = presetData[preset];
      const table = document.getElementById("sheet");
      
      // Clear existing rows
      while (table.rows.length > 1) {
        table.deleteRow(1);
      }
      
      // Update headers
      for (let i = 0; i < data.headers.length; i++) {
        if (i < table.rows[0].cells.length) {
          table.rows[0].cells[i].innerText = data.headers[i];
        } else {
          const cell = table.rows[0].insertCell();
          cell.outerHTML = `<th>${data.headers[i]}</th>`;
        }
      }
      
      // Add data rows
      data.data.forEach(rowData => {
        const row = table.insertRow();
        rowData.forEach(cellData => {
          const cell = row.insertCell();
          cell.innerHTML = `<input class="basicinput" value="${cellData}">`;
        });
      });
      
      // Remove extra columns if needed
      while (table.rows[0].cells.length > data.headers.length) {
        for (let i = 0; i < table.rows.length; i++) {
          table.rows[i].deleteCell(table.rows[i].cells.length - 1);
        }
      }
    }

    function downloadSpreadsheet() {
      const table = document.getElementById("sheet");
      const data = [];
      
      // Get headers
      const headers = [];
      for (let i = 0; i < table.rows[0].cells.length; i++) {
        headers.push(table.rows[0].cells[i].innerText);
      }
      data.push(headers);
      
      // Get data rows
      for (let r = 1; r < table.rows.length; r++) {
        const rowData = [];
        for (let c = 0; c < table.rows[r].cells.length; c++) {
          const inp = table.rows[r].cells[c].querySelector("input");
          rowData.push(inp ? inp.value : table.rows[r].cells[c].innerText);
        }
        data.push(rowData);
      }
      
      // Create worksheet and workbook
      const ws = XLSX.utils.aoa_to_sheet(data);
      const wb = XLSX.utils.book_new();
      XLSX.utils.book_append_sheet(wb, ws, "Sheet1");
      
      // Download the file
      XLSX.writeFile(wb, "leprVisuals_Data.xlsx");
    }

    function handleFileUpload(files) {
      if (!files.length) return;
      
      const file = files[0];
      const reader = new FileReader();
      
      reader.onload = function(e) {
        const data = new Uint8Array(e.target.result);
        const workbook = XLSX.read(data, {type: 'array'});
        
        // Get first worksheet
        const worksheet = workbook.Sheets[workbook.SheetNames[0]];
        
        // Convert to JSON (limit to first 365 rows)
        const jsonData = XLSX.utils.sheet_to_json(worksheet, {header: 1});
        
        // Update the table
        const table = document.getElementById("sheet");
        
        // Clear existing rows
        while (table.rows.length > 0) {
          table.deleteRow(0);
        }
        
        // Add new rows (limit to 365)
        const maxRows = Math.min(jsonData.length, 366); // 1 header + 365 data rows
        
        for (let r = 0; r < maxRows; r++) {
          const row = table.insertRow();
          // Only use first two columns
          const maxCols = Math.min(jsonData[r].length, 2);
          
          for (let c = 0; c < maxCols; c++) {
            const cell = row.insertCell();
            if (r === 0) {
              cell.outerHTML = `<th>${jsonData[r][c] || `Column ${c+1}`}</th>`;
            } else {
              cell.innerHTML = `<input class="basicinput" value="${jsonData[r][c] || ''}">`;
            }
          }
        }
      };
      
      reader.readAsArrayBuffer(file);
    }

    function toggleCustomSize() {
      const sizeType = document.getElementById("chartSize").value;
      const customInputs = document.getElementById("customSizeInputs");
      
      if (sizeType === "custom") {
        customInputs.style.display = "flex";
      } else {
        customInputs.style.display = "none";
      }
    }

    function generateChartFromSheet() {
      const table = document.getElementById("sheet");
      const rows = [];
      
      for (let r = 0; r < table.rows.length; r++) {
        const cells = [];
        for (let c = 0; c < table.rows[r].cells.length; c++) {
          const inp = table.rows[r].cells[c].querySelector("input");
          cells.push(inp ? inp.value : table.rows[r].cells[c].innerText);
        }
        rows.push(cells);
      }

      if (rows.length < 2) {
        alert("Need at least 1 data row.");
        return;
      }

      const labels = rows.slice(1).map(r => r[0]);
      const values = rows.slice(1).map(r => Number(r[1]));

      const ctx = document.getElementById("chartCanvas").getContext("2d");
      const chartType = document.getElementById("chartType").value;
      
      // Handle chart size
      const sizeType = document.getElementById("chartSize").value;
      const chartWrapper = document.getElementById("chartWrapper");
      
      if (sizeType === "window") {
        chartWrapper.style.width = "90%";
        chartWrapper.style.height = "90vh";
        chartWrapper.style.maxHeight = "90%";
      } else if (sizeType === "square") {
        const size = Math.min(window.innerWidth * 0.9, window.innerHeight * 0.9);
        chartWrapper.style.width = `${size}px`;
        chartWrapper.style.height = `${size}px`;
        chartWrapper.style.maxHeight = "none";
      } else if (sizeType === "custom") {
        const width = document.getElementById("customWidth").value || 800;
        const height = document.getElementById("customHeight").value || 600;
        chartWrapper.style.width = `${width}px`;
        chartWrapper.style.height = `${height}px`;
        chartWrapper.style.maxHeight = "none";
      }

      if (chart) chart.destroy();
      
      // Prepare chart data based on type
      let chartData;
      if (chartType === "bubble") {
        // For bubble charts, we need x, y, and r values
        chartData = {
          datasets: [{
            label: rows[0][1] || "Values",
            data: values.map((v, i) => ({
              x: i,
              y: v,
              r: Math.min(Math.max(v / Math.max(...values) * 20, 5), 30)
            })),
            backgroundColor: "#ffd600",
            borderColor: "#000",
            borderWidth: 1
          }]
        };
      } else if (chartType === "scatter") {
        // For scatter plots, we need x and y values
        chartData = {
          datasets: [{
            label: rows[0][1] || "Values",
            data: values.map((v, i) => ({
              x: i,
              y: v
            })),
            backgroundColor: "#ffd600",
            borderColor: "#000",
            borderWidth: 1
          }]
        };
      } else {
        // For other chart types
        chartData = {
          labels,
          datasets: [{
            label: rows[0][1] || "Values",
            data: values,
            backgroundColor: [
              "#ffd600", "#2de2a6", "#ff3864", "#f5f5f5", "#ffed4e", "#00bcd4", "#8e44ad"
            ],
            borderColor: "#0b0b12",
            borderWidth: 1
          }]
        };
      }

      chart = new Chart(ctx, {
        type: chartType,
        data: chartData,
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: { 
              position: "bottom", 
              labels: { 
                color: "#0b0b12",
                font: {
                  size: 14
                }
              } 
            },
            title: {
              display: true,
              text: 'leprVisuals Chart',
              color: "#0b0b12",
              font: {
                size: 18
              }
            }
          },
          scales: (chartType !== "pie" && chartType !== "doughnut" && chartType !== "polarArea") ? {
            x: { 
              ticks: { color: "#0b0b12" },
              grid: {
                color: "rgba(0,0,0,0.1)"
              }
            },
            y: { 
              ticks: { color: "#0b0b12" },
              grid: {
                color: "rgba(0,0,0,0.1)"
              }
            }
          } : {}
        }
      });
      
      // Scroll to chart
      document.getElementById("chartWrapper").scrollIntoView({ 
        behavior: 'smooth' 
      });
    }

    function showScreenshotOptions() {
      if (!chart) {
        alert("Generate a chart first!");
        return;
      }
      document.getElementById("screenshotModal").style.display = "flex";
    }

    function takeScreenshot() {
      const canvas = document.getElementById("chartCanvas");
      const bgType = document.querySelector('input[name="bgType"]:checked').value;
      const margin = parseInt(document.getElementById("marginSize").value) || 0;
      
      // Create a temporary canvas with margin
      const tempCanvas = document.createElement('canvas');
      const tempCtx = tempCanvas.getContext('2d');
      
      tempCanvas.width = canvas.width + margin * 2;
      tempCanvas.height = canvas.height + margin * 2;
      
      // Fill background
      if (bgType === 'white') {
        tempCtx.fillStyle = '#ffffff';
        tempCtx.fillRect(0, 0, tempCanvas.width, tempCanvas.height);
      } else {
        tempCtx.clearRect(0, 0, tempCanvas.width, tempCanvas.height);
      }
      
      // Draw the chart with margin
      tempCtx.drawImage(canvas, margin, margin);
      
      // Download the image
      const link = document.createElement("a");
      link.href = tempCanvas.toDataURL("image/png");
      link.download = `leprVisuals_chart_${new Date().getTime()}.png`;
      link.click();
      
      // Close the modal
      document.getElementById("screenshotModal").style.display = "none";
    }
  </script>
</body>
</html>
</center>

